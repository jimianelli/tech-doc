a4aSCA                  package:FLa4a                  R Documentation

_s_t_a_t_i_s_t_i_c_a_l _c_a_t_c_h-_a_t-_a_g_e _a_d_v_a_n_c_e_d _m_e_t_h_o_d

_D_e_s_c_r_i_p_t_i_o_n:

     Advanced user interface to the statistical catch-at-age method of
     the a4a stock assessment framework.

_A_r_g_u_m_e_n_t_s:

  fmodel: a formula object depicting the model for log fishing
          mortality at age

  qmodel: a list of formula objects depicting the models for log survey
          catchability at age

 srmodel: a formula object depicting the model for log recruitment

   stock: an FLStock object containing catch and stock information

 indices: an FLIndices object containing survey indices

   covar: a list with covariates

   wkdir: used to set a working directory for the admb optimiser.  If
          wkdir is set all admb files are saved to this folder
          otherwise they are deleted.

 verbose: if true admb fitting information is printed to the screen

     fit: Character with type of fit, 'MP' or 'assessment', the first
          doesn't require the hessian to be computed, while the former
          does.

_V_a_l_u_e:

     an ‘a4aFit’ object if fit is "MP" or an ‘a4aFitSA’ if fit is
     "assessment"

_E_x_a_m_p_l_e_s:

     data(ple4)
     data(ple4.index)
     
     # fishing mortality by age and year (~separable) AND catchability at age without year trend
     fmodel <- ~factor(age) + factor(year)
     qmodel <- list(~factor(age))
     fit1 <-  a4aSCA(fmodel=fmodel, qmodel=qmodel, stock=ple4, indices=FLIndices(ple4.index))
     
     # fishing mortality as a smoother by age and year AND catchability at age without year trend
     fmodel <- ~ s(age, k=4) + s(year, k=10)
     fit2 <-  a4aSCA(fmodel=fmodel, qmodel=qmodel, stock=ple4, indices=FLIndices(ple4.index))
     
     # fishing mortality as a smoother by age and year AND catchability at age without year trend
     fmodel <- ~ s(age, k=4) + s(year, k=10)
     qmodel <- list(~s(age, k=4) + year)
     fit3 <-  a4aSCA(fmodel=fmodel, qmodel=qmodel, stock=ple4, indices=FLIndices(ple4.index))
     
     # fishing mortality as a smoother by age and year AND catchability at age with year trend
     fmodel <- ~ te(age, year, k=c(4, 10))
     qmodel <- list(~s(age, k=4))
     fit4 <-  a4aSCA(fmodel=fmodel, qmodel=qmodel, stock=ple4, indices=FLIndices(ple4.index))
     
     # It's a statistical model
     BIC(fit1, fit2, fit3)
     
     # fit3 + smoother in recruitment
     fmodel <- ~ s(age, k=4) + s(year, k=20)
     qmodel <- list(~s(age, k=4))
     rmodel <- ~s(year, k=20)
     fit5 <-  a4aSCA(fmodel=fmodel, qmodel=qmodel, srmodel=rmodel, ple4, FLIndices(ple4.index))
     
     # fit3 + bevholt
     rmodel <- ~ bevholt(CV=0.05)
     fit6 <-  a4aSCA(fmodel=fmodel, qmodel=qmodel, srmodel=rmodel, ple4, FLIndices(ple4.index))
     

