\documentclass[a4paper,english,10pt]{article}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{cite}
\usepackage{color} 
\usepackage{float}
\usepackage{longtable}
\usepackage[bottom]{footmisc}
\usepackage{url}
\usepackage{natbib}
\usepackage{authblk}
\usepackage[T1]{fontenc}
\usepackage[utf8x]{inputenc}
\usepackage{babel}
\usepackage{hyperref}
\usepackage{geometry}
\geometry{verbose,a4paper,tmargin=3cm,bmargin=2cm,lmargin=2cm,rmargin=3cm}
\setlength{\parskip}{\medskipamount}
\setlength{\parindent}{0pt}
\hypersetup{
    colorlinks=true,       % false: boxed links; true: colored links
    linkcolor=blue,        % color of internal links
    citecolor=red,         % color of links to bibliography
    filecolor=blue,        % color of file links
    urlcolor=blue          % color of external links
}

\usepackage{Sweave}
\begin{document}
\input{a4aAssessmentMethodology-concordance}

\title{Stock assessment and management advice with a4a methods \\ DRAFT}

\author[1]{Ernesto Jardim}
\author[1]{Colin Millar}
\author[1]{Finlay Scott}
\affil[1]{European Commission, Joint Research Centre, IPSC / Maritime Affairs Unit, 21027 Ispra (VA), Italy}
\affil[*]{Corresponding author \href{mailto:ernesto.jardim@jrc.ec.europa.eu}{ernesto.jardim@jrc.ec.europa.eu}}

\maketitle
\tableofcontents
\newpage

\section{Introduction}

\begin{itemize}
	\item Objectives
	\item a4a concepts
	\begin{itemize}
		\item life history considers parameters to have distributions, it's a kind of Bayesian posteriors informed estimates, but if one runs a Bayesian analysis to estimate growth parameters the posteriors can be used  
	\end{itemize}
	\item Workflow diagram
\end{itemize}


\begin{Schunk}
\begin{Sinput}
> #==============================================================================
> # libraries and constants 
> #==============================================================================
> 
> library(FLa4a)
> library(XML)
> library(reshape2)
> data(rfLen)
> data(ple4)
> data(ple4.indices)
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> #==============================================================================
> # some functions for later 
> #==============================================================================
> # quant 2 quant
> qt2qt <- function(object, id=5, split="-"){
+ 	qt <- object[,id]
+ 	levels(qt) <- unlist(lapply(strsplit(levels(qt), split=split), "[[", 2))
+ 	as.numeric(as.character(qt))
+ }
> # check import and massage
> cim <- function(object, n, wt, hrv="missing"){
+ 	v <- object[sample(1:nrow(object), 1),]
+ 	c1 <- c(n[as.character(v$V5),as.character(v$V1),1,as.character(v$V2)]==v$V6)
+ 	c2 <- c(wt[as.character(v$V5),as.character(v$V1),1,as.character(v$V2)]==v$V7)
+ 	if(missing(hrv)){
+ 		c1 + c2 == 2	
+ 	} else {
+ 		c3 <- c(hrv[as.character(v$V5),as.character(v$V1),1,as.character(v$V2)]==v$V8)
+ 		c1 + c2 + c3 == 3	
+ 	}
+ }
\end{Sinput}
\end{Schunk}

\section{Reading files and building FLR objects}

For this document we'll use the plaice in ICES area IV dataset, provided by FLR, and a length-based simulated dataset based on red fish, using gadget (http://www.hafro.is/gadget), provided by Daniel Howell (Institute of Marine Research, Norway).

\subsection{Red fish length based dataset}

\begin{Schunk}
\begin{Sinput}
> #==============================================================================
> # Read files
> #==============================================================================
> 
> # catch
> cth.orig <- read.table("data/catch.len", skip=5)